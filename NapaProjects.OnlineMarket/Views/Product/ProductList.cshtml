
@model IEnumerable<ProductModel>

<div class="p-2 bg-primary" style="color: white;">
    <h3>
        Product List
    </h3>
</div>

<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Name</th><th>Category</th><th>Price</th>@if (User.isAdmin()) { <th></th>} <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var product in Model)
        {
            <tr>
                <td>@product.Name</td><td>@product.CategoryName</td><td>@product.Price</td>
                @if (User.isAdmin())
                {
                    <td>
                        <a asp-action="HistoryWithId" asp-controller="History" asp-route-id="@product.Id"
                        asp-route-returnUrl="@Context.PathAndQuery()">History details</a>
                    </td>
                }
                <td>
                    @if (User.isUser() || User.isUser())
                    {
                        <form method="post" >
                            <input type="hidden" name="returnUrl" value="@Context.PathAndQuery()"/>
                            <input type="hidden" name="id" value="@product.Id"/>
                            <button type="submit" asp-action="DeleteProduct" class="btn btn-outline-danger">
                                Delete
                            </button>
                            @if (User.isAdmin())
                            {
                                <a class="btn btn-outline-primary" asp-action="UpdateProduct"
                       asp-route-id="@product.Id" asp-route-returnUrl="@Context.PathAndQuery()">
                                    Update
                                </a>
                            <a class="btn btn-success" asp-action="AddToCart" asp-controller="Cart"
                            asp-route-returnUrl="@Context.PathAndQuery()" asp-route-productId="@product.Id">
                                Add to cart
                            </a>
                            
                            }
                        </form>

                    }else {
                        <p>To order product you must signin</p>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>
<div class="p-1" style="align-items: center;">
    <a class="btn btn-primary col-5" asp-action="CreateProduct" asp-route-returnUrl="@Context.PathAndQuery()">
        Create a new product
    </a>
</div>